# door-motor/Dockerfile.template
FROM balenalib/%%BALENA_MACHINE_NAME%%-debian:bullseye

# Use balena's helper to install OS packages (no compiling needed)
RUN install_packages \
      python3 python3-pip python3-flask python3-pigpio ca-certificates curl && \
    update-ca-certificates

WORKDIR /usr/src/app
COPY . .
EXPOSE 3000

# Talk to the pigpio sidecar
ENV PIGPIO_ADDR=pigpio
ENV PIGPIO_PORT=8888

# Start the Flask app
CMD ["python3", "door-motor.py"]
